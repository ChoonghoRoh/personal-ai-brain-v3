# PAB 검색 통합/개선 보고서

**작성일**: 2026-02-21 23:30
**범위**: 검색 메뉴(/search) 및 검색 API, 검색-지식구조-AI 질의 연계
**근거 문서**: [docs/overview/cursor-overview-260208.md](../overview/cursor-overview-260208.md), [docs/overview/vscode-overview-260208.md](../overview/vscode-overview-260208.md), [docs/overview/claude-backend-overview-260209-1635.md](../overview/claude-backend-overview-260209-1635.md)

---

## 1. 현재 기능 설명

### 1.1 메뉴/화면

- 사용자 메뉴 **검색**: `/search`, 화면 `search.html`
- 주요 기능: 하이브리드 검색(키워드+벡터), 필터링, 문서 목록 조회

### 1.2 API/서비스

- `/api/search` (GET): 하이브리드 검색
- `/api/search/advanced` 또는 `/api/search/hybrid` (POST): 고급 검색
- `/api/documents` (GET): 문서 목록
- 서비스: 하이브리드 검색 RRF 결합(가중치 0.7/0.3), Qdrant 벡터 + PostgreSQL 키워드

### 1.3 사용자 사용 흐름(현재)

1. 검색어 입력 → 결과 리스트 확인
2. 필터 조건(날짜/라벨/타입 등) 적용
3. 상세 문서/청크 확인 → 필요 시 지식 구조 또는 AI 질의로 이동

---

## 2. 사용 후기(가설 기반)

- **강점**: 하이브리드 검색으로 리콜 확보, Qdrant 연동으로 의미 검색 가능
- **약점**: 필터 구조가 단순해 정밀 탐색에 한계, 결과 신뢰도 설명 부족

---

## 3. 사용 불편점 및 리스크

| 구분 | 증상                                           | 영향           | 우선순위 |
| ---- | ---------------------------------------------- | -------------- | -------- |
| UX   | 검색 조건(라벨/관계/프로젝트)의 고급 결합 불가 | 정밀 검색 실패 | 높음     |
| 품질 | 결과 근거/출처 설명 부족                       | 신뢰도 저하    | 높음     |
| 성능 | 키워드 검색 성능은 GIN 인덱스 부재 시 저하     | 응답 지연      | 높음     |
| 운영 | 검색/AI/지식 간 용어·필터 불일치               | 통합 경험 분절 | 중간     |
| 보안 | 민감 청크 검색 권한 제어 미정                  | 정보 노출 위험 | 중간     |

---

## 4. 통합/서비스 개선 방향

### 4.1 통합 설계

- **검색 ↔ 지식 구조 연계**: 검색 결과를 지식 그래프(라벨/관계)와 양방향 연결
- **검색 ↔ AI 질의 연계**: 검색 결과를 컨텍스트로 전달해 근거 기반 응답(출처 포함)
- **필터 통합**: 라벨/프로젝트/등급/승인 상태 필터를 모든 메뉴에서 공통 적용

### 4.2 서비스 개선(성능/신뢰)

- `knowledge_chunks.content` GIN 인덱스 적용
- 검색 캐시(쿼리+필터 기반, TTL)
- 결과 설명: 검색 스코어, 매칭 타입(키워드/벡터/하이브리드) 표시
- 검색 품질 모드(정밀/균형/광범위) 프리셋

---

## 5. 기능 고도화 제안

### 5.1 고급 검색

- Boolean 쿼리, 필드 검색(라벨/작성일/프로젝트/승인상태)
- 결과 내 검색(결과 리스트 재필터)
- 유사 문서 추천 및 중복 제거

### 5.2 검색 결과 액션 강화

- 검색 결과 → 지식 그래프 진입(라벨/관계 하이라이트)
- 결과 → AI 질의(선택 청크만 컨텍스트로 전달)
- 결과 → 문서 재조합/내보내기 연결

---

## 6. 보안/운영/정책

- RBAC + 민감도 등급별 필터링
- 검색/다운로드 감사 로그 기록
- Rate Limiting: 공개/관리자/AI 연계 요청 분리
- 검색 결과의 민감 정보 마스킹 옵션

---

## 7. 테스트·검증 계획

### 7.1 pytest (Backend)

- 하이브리드 검색 점수 결합 검증
- 필터(라벨/프로젝트/승인 상태) 정확성
- 권한 필터링(민감도 등급) 차단

### 7.2 Playwright (E2E)

- 검색 → 지식 구조 이동 흐름
- 검색 → AI 질의 컨텍스트 전달
- 고급 필터 조합 결과 정확성

---

## 8. 단계별 실행 시나리오

- **1단계**: 필터 통합, GIN 인덱스, 캐싱 적용
- **2단계**: 결과 설명/출처 표시, 검색 품질 모드
- **3단계**: 지식 구조/AI 질의 연계, 고급 검색 UI

---

## 9. KPI 제안

- 검색 평균 응답 시간 < 300ms
- “결과 없음” 비율 20% 감소
- 검색 → AI 질의 전환율 +30%
- 검색 관련 불만(정확도/신뢰도) 50% 감소

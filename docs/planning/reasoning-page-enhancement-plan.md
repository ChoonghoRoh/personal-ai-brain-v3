# Reasoning 페이지 고도화 기획서

**버전**: 1.0
**작성일**: 2026-02-03
**상태**: 초안 (Draft)

---

## 1. 현재 상태 분석

### 1.1 현재 Reasoning 모드 구조

| 모드 | 페르소나 | 현재 용도 | 한계점 |
|------|---------|----------|--------|
| **design_explain** | 소프트웨어 아키텍트 | 설계 의도/배경 설명 | 단순 텍스트 나열 |
| **risk_review** | 리스크 분석가 | 위험 요소 발견 | 시각화 부재 |
| **next_steps** | 프로젝트 매니저 | 다음 단계 제안 | 우선순위/일정 없음 |
| **history_trace** | 기술 문서 전문가 | 히스토리 추적 | 타임라인 없음 |

### 1.2 현재 LLM 사용 흐름의 문제점

```
[현재]
사용자 클릭 → 로딩 스피너(경과시간만) → 완료
                    ↑
            무슨 작업 중인지 알 수 없음
```

**문제점**:
- 로컬 LLM 응답 시간: 5~30초 (모델 크기, 질문 복잡도에 따라)
- 사용자가 "멈춘 건가?" 혼란
- 중간 진행 상황 피드백 없음

---

## 2. 개선 방안 제시

### 2.1 모드별 분석 방식 차별화

#### Mode 1: design_explain (설계 설명)
```
[현재]
"설계 의도와 배경을 설명합니다..."

[개선안]
┌─────────────────────────────────────────────┐
│ 📐 설계 분석 결과                            │
├─────────────────────────────────────────────┤
│ ▸ 핵심 설계 결정 (3개)                       │
│   1. [결정1] - 이유: ...                     │
│   2. [결정2] - 이유: ...                     │
│   3. [결정3] - 이유: ...                     │
│                                             │
│ ▸ 관련 아키텍처 다이어그램                   │
│   [Mermaid 다이어그램 렌더링]                │
│                                             │
│ ▸ 참조된 설계 원칙                           │
│   - SOLID, DRY, ...                         │
└─────────────────────────────────────────────┘
```

**분석 접근법**:
- 청크에서 "결정", "선택", "이유", "배경" 키워드 추출
- 관련 문서 간 의존 관계를 Mermaid 다이어그램으로 시각화
- 설계 패턴/원칙 자동 태깅

---

#### Mode 2: risk_review (리스크 분석)
```
[현재]
"잠재적 위험과 고려사항을 분석합니다..."

[개선안]
┌─────────────────────────────────────────────┐
│ ⚠️ 리스크 분석 결과                          │
├─────────────────────────────────────────────┤
│ 🔴 높음 (2개)                               │
│   • 보안 취약점 - API 인증 미구현            │
│   • 성능 병목 - N+1 쿼리 문제                │
│                                             │
│ 🟡 중간 (3개)                               │
│   • 기술 부채 - 테스트 커버리지 40%          │
│   • ...                                     │
│                                             │
│ 🟢 낮음 (1개)                               │
│   • 문서화 부족                              │
│                                             │
│ ▸ 영향도 그래프                             │
│   [노드-엣지 그래프: 영향 범위 시각화]        │
└─────────────────────────────────────────────┘
```

**분석 접근법**:
- 리스크 키워드 매칭: "위험", "주의", "TODO", "FIXME", "문제"
- 관계 그래프 기반 영향 범위 분석
- 심각도 자동 분류 (High/Medium/Low)

---

#### Mode 3: next_steps (다음 단계)
```
[현재]
"다음 단계를 제안합니다..."

[개선안]
┌─────────────────────────────────────────────┐
│ 🚀 다음 단계 로드맵                          │
├─────────────────────────────────────────────┤
│ Phase 1: 즉시 실행 가능 (1-2일)              │
│   □ Task A - 예상 난이도: ★☆☆               │
│   □ Task B - 예상 난이도: ★★☆               │
│                                             │
│ Phase 2: 단기 목표 (1주일)                   │
│   □ Task C - 의존성: Task A                 │
│   □ Task D - 의존성: Task B                 │
│                                             │
│ Phase 3: 중기 목표 (1개월)                   │
│   □ Task E                                  │
│                                             │
│ ▸ 간트 차트 미리보기                         │
│   [타임라인 시각화]                          │
└─────────────────────────────────────────────┘
```

**분석 접근법**:
- TODO, PLANNED, NEXT 태그 추출
- 의존성 분석으로 실행 순서 결정
- 난이도 추정 (코드 복잡도, 파일 수 기반)

---

#### Mode 4: history_trace (히스토리 추적)
```
[현재]
"히스토리와 맥락을 추적합니다..."

[개선안]
┌─────────────────────────────────────────────┐
│ 📜 의사결정 타임라인                         │
├─────────────────────────────────────────────┤
│ 2026-02-01 ─┬─ Phase 9-3 계획 수립          │
│             │   └ 결정: AI 기능 우선 개발    │
│             │                               │
│ 2026-01-28 ─┼─ RAG 기능 설계 검토           │
│             │   └ 결정: Hybrid Search 채택   │
│             │                               │
│ 2026-01-25 ─┴─ 초기 아키텍처 설계            │
│                 └ 결정: FastAPI + Qdrant     │
│                                             │
│ ▸ 변경 사항 비교                             │
│   [Before/After 비교 뷰]                     │
└─────────────────────────────────────────────┘
```

**분석 접근법**:
- 문서 내 날짜 패턴 추출
- git 커밋 메시지 연계 (선택적)
- 버전별 변경 사항 diff 생성

---

### 2.2 로컬 LLM 사용 중 UX/UI 개선

#### 2.2.1 진행 상태 표시 (Streaming-like UX)

```
┌─────────────────────────────────────────────┐
│ 🤖 AI가 분석 중입니다...                     │
├─────────────────────────────────────────────┤
│                                             │
│  ✅ 질문 분석 완료                           │
│  ✅ 관련 문서 15개 검색 완료                 │
│  ✅ 관계 추적 완료 (8개 추가)                │
│  🔄 LLM 추론 중... (12초 경과)              │
│     [████████████░░░░░░░░] 60%              │
│                                             │
│  💡 팁: 복잡한 질문일수록 시간이 걸립니다    │
│                                             │
│  [취소하기]                                  │
└─────────────────────────────────────────────┘
```

#### 2.2.2 단계별 상태 정의

| 단계 | 예상 시간 | 표시 메시지 |
|------|----------|------------|
| 1. 입력 파싱 | <1초 | "질문 분석 중..." |
| 2. 의미 검색 | 1-3초 | "관련 문서 검색 중..." |
| 3. 관계 추적 | 1-2초 | "연관 지식 확장 중..." |
| 4. 컨텍스트 구성 | <1초 | "컨텍스트 준비 중..." |
| 5. LLM 추론 | 5-25초 | "AI가 분석 중... (N초)" |
| 6. 추천 생성 | 1-3초 | "추천 정보 생성 중..." |

#### 2.2.3 사용자 피드백 요소

```javascript
// 예상 시간 표시
"예상 소요 시간: 약 15-20초"

// 모델 정보 표시
"사용 모델: eeve-korean (8B parameters)"

// 취소 기능
"[취소] 버튼으로 언제든 중단 가능"

// 오래 걸릴 때 안내
(30초 초과 시) "복잡한 질문이라 시간이 걸리고 있습니다.
               더 구체적인 질문으로 다시 시도해보세요."
```

#### 2.2.4 부분 결과 스트리밍 (고급)

```
LLM 응답 중 실시간 표시:
┌─────────────────────────────────────────────┐
│ 💡 최종 결론                                 │
├─────────────────────────────────────────────┤
│ Phase 9-3은 AI 기능 고도화를 목표로 하며,    │
│ 특히 RAG 검색 정확도 향상이 핵심입니다.      │
│ █ (타이핑 중...)                            │
└─────────────────────────────────────────────┘
```

---

### 2.3 모드별 결과물 형식 변경

#### 2.3.1 공통 결과 구조

```
┌─────────────────────────────────────────────┐
│ [모드 아이콘] [모드명] 분석 결과              │
├─────────────────────────────────────────────┤
│                                             │
│ 📊 요약 (Summary)                           │
│ ─────────────────                           │
│ • 핵심 포인트 3줄 요약                       │
│                                             │
│ 📋 상세 분석 (Details)                       │
│ ─────────────────                           │
│ [모드별 맞춤 형식]                           │
│                                             │
│ 📈 시각화 (Visualization)                    │
│ ─────────────────                           │
│ [모드별 다이어그램/차트]                     │
│                                             │
│ 💡 인사이트 (Insights)                       │
│ ─────────────────                           │
│ • AI가 발견한 추가 관점                      │
│                                             │
│ 🔗 관련 정보 (Recommendations)               │
│ ─────────────────                           │
│ [기존 추천 섹션]                             │
│                                             │
└─────────────────────────────────────────────┘
```

#### 2.3.2 모드별 시각화 요소

| 모드 | 시각화 타입 | 라이브러리 |
|------|-----------|-----------|
| design_explain | 아키텍처 다이어그램 | Mermaid.js |
| risk_review | 리스크 매트릭스, 영향 그래프 | Chart.js, D3.js |
| next_steps | 간트 차트, 칸반 보드 | Gantt.js |
| history_trace | 타임라인, Before/After | Timeline.js |

#### 2.3.3 출력 형식 옵션

```
┌─────────────────────────────────────────────┐
│ 📤 내보내기 옵션                             │
├─────────────────────────────────────────────┤
│ [Markdown] [PDF] [Notion] [Confluence]       │
└─────────────────────────────────────────────┘
```

---

## 3. 전체 구현 계획 (Implementation Plan)

### 3.1 Phase 구조

```
Phase A: UX/UI 개선 (1주)
├── A-1: 진행 상태 표시 개선
├── A-2: 취소 기능 구현
└── A-3: 예상 시간 표시

Phase B: 모드별 분석 고도화 (2주)
├── B-1: design_explain 시각화
├── B-2: risk_review 매트릭스
├── B-3: next_steps 로드맵
└── B-4: history_trace 타임라인

Phase C: 결과물 형식 개선 (1주)
├── C-1: 공통 결과 구조 적용
├── C-2: 시각화 라이브러리 통합
└── C-3: 내보내기 기능

Phase D: 고급 기능 (2주, 선택)
├── D-1: LLM 스트리밍 응답
├── D-2: 협업 기능 (공유, 댓글)
└── D-3: 버전 관리
```

### 3.2 우선순위 매트릭스

| 기능 | 영향도 | 난이도 | 우선순위 |
|------|-------|-------|---------|
| 진행 상태 표시 | 높음 | 낮음 | **P0** |
| 취소 기능 | 중간 | 낮음 | **P0** |
| risk_review 매트릭스 | 높음 | 중간 | **P1** |
| next_steps 로드맵 | 높음 | 중간 | **P1** |
| design_explain 다이어그램 | 중간 | 중간 | **P2** |
| history_trace 타임라인 | 중간 | 높음 | **P2** |
| LLM 스트리밍 | 높음 | 높음 | **P3** |
| 내보내기 기능 | 낮음 | 중간 | **P3** |

---

## 4. 이해관계자별 요구사항 정의

### 4.1 경영자 (Business Owner) 관점

#### 핵심 관심사
- **ROI**: 이 기능이 업무 효율을 얼마나 높이는가?
- **사용성**: 비개발자도 쉽게 사용 가능한가?
- **가치**: 의사결정에 실제로 도움이 되는가?

#### 요구사항 목록

| ID | 요구사항 | 우선순위 | 상태 |
|----|---------|---------|------|
| BIZ-001 | 분석 결과를 한눈에 파악할 수 있는 요약 제공 | P0 | 계획 |
| BIZ-002 | 리스크 분석 시 비즈니스 영향도 표시 | P1 | 계획 |
| BIZ-003 | 의사결정 근거를 문서로 저장/공유 | P1 | 계획 |
| BIZ-004 | 분석 결과 PDF/보고서 형태 출력 | P2 | 계획 |
| BIZ-005 | 대시보드에서 주요 리스크 현황 확인 | P2 | 계획 |

#### 성공 지표 (KPI)
- 분석 기능 주간 사용량 50회 이상
- 의사결정 문서 생성 비율 30% 이상
- 사용자 만족도 (NPS) 7점 이상

---

### 4.2 개발자 (Developer) 관점

#### 핵심 관심사
- **확장성**: 새 모드 추가가 쉬운가?
- **성능**: API 응답 시간이 적절한가?
- **코드 품질**: 유지보수가 용이한가?

#### 요구사항 목록

| ID | 요구사항 | 우선순위 | 상태 |
|----|---------|---------|------|
| DEV-001 | 모드별 분석 로직 플러그인 구조 | P0 | 계획 |
| DEV-002 | LLM 호출 타임아웃 및 취소 기능 | P0 | 계획 |
| DEV-003 | 분석 결과 캐싱 (동일 질문 재사용) | P1 | 계획 |
| DEV-004 | 프롬프트 템플릿 외부 설정화 | P1 | 계획 |
| DEV-005 | 분석 로그 및 성능 메트릭 수집 | P2 | 계획 |
| DEV-006 | 테스트 커버리지 80% 이상 유지 | P1 | 계획 |

#### 기술 제약사항
- 로컬 LLM 응답 시간: 30초 타임아웃
- 메모리 제한: Reranker 모델 로딩 시 +500MB
- 동시 요청: 최대 5개 (Ollama 제한)

---

### 4.3 디자이너 (Designer) 관점

#### 핵심 관심사
- **일관성**: 기존 UI와 조화로운가?
- **접근성**: 모든 사용자가 이용 가능한가?
- **직관성**: 처음 사용자도 이해하기 쉬운가?

#### 요구사항 목록

| ID | 요구사항 | 우선순위 | 상태 |
|----|---------|---------|------|
| DES-001 | 로딩 상태의 명확한 시각적 피드백 | P0 | 계획 |
| DES-002 | 모드별 아이콘 및 색상 체계 정의 | P0 | 계획 |
| DES-003 | 결과 영역 정보 계층 구조 명확화 | P1 | 계획 |
| DES-004 | 시각화 요소 반응형 디자인 | P1 | 계획 |
| DES-005 | 다크 모드 지원 | P2 | 계획 |
| DES-006 | 접근성 가이드라인 (WCAG 2.1 AA) 준수 | P2 | 계획 |

#### 디자인 시스템 연계
```
색상 팔레트:
- Primary: #2563eb (파란색)
- Success: #16a34a (녹색)
- Warning: #f59e0b (주황색)
- Danger: #dc2626 (빨간색)
- Neutral: #6b7280 (회색)

모드별 테마 색상:
- design_explain: #8b5cf6 (보라)
- risk_review: #f59e0b (주황)
- next_steps: #16a34a (녹색)
- history_trace: #6366f1 (인디고)
```

---

## 5. 요구사항 추적 체계

### 5.1 추적 매트릭스 구조

```
docs/planning/requirements/
├── requirements-master.md       # 전체 요구사항 목록
├── requirements-business.md     # 경영자 요구사항
├── requirements-developer.md    # 개발자 요구사항
├── requirements-designer.md     # 디자이너 요구사항
├── traceability-matrix.md       # 추적 매트릭스
└── change-log.md                # 변경 이력
```

### 5.2 요구사항 추적 매트릭스

| Req ID | 설명 | 이해관계자 | Task | 테스트 | 상태 |
|--------|------|-----------|------|--------|------|
| BIZ-001 | 요약 제공 | 경영자 | B-1 | T-001 | 계획 |
| DEV-001 | 플러그인 구조 | 개발자 | A-1 | T-002 | 계획 |
| DES-001 | 로딩 피드백 | 디자이너 | A-1 | T-003 | 계획 |
| ... | ... | ... | ... | ... | ... |

### 5.3 상태 정의

| 상태 | 설명 | 색상 |
|------|------|------|
| 계획 (Planned) | 요구사항 정의됨 | 회색 |
| 진행중 (In Progress) | 개발 진행 중 | 파랑 |
| 검토 (Review) | 코드/디자인 리뷰 중 | 주황 |
| 완료 (Done) | 구현 및 테스트 완료 | 녹색 |
| 보류 (Hold) | 우선순위 조정으로 보류 | 빨강 |

### 5.4 변경 관리 프로세스

```
1. 변경 요청 (CR) 생성
   ↓
2. 영향도 분석
   ├─ 연관 요구사항 파악
   ├─ 작업량 추정
   └─ 이해관계자 협의
   ↓
3. 승인/반려
   ↓
4. 요구사항 문서 업데이트
   ↓
5. 추적 매트릭스 갱신
```

---

## 6. 다음 단계 (Next Steps)

### 즉시 실행 (이번 주)
1. [ ] 요구사항 상세 문서 생성 (requirements-*.md)
2. [ ] 디자인 와이어프레임 작성 (Figma/Sketch)
3. [ ] Phase A-1 작업 시작 (진행 상태 표시)

### 단기 목표 (2주 내)
1. [ ] UX/UI 개선 완료 (Phase A)
2. [ ] 이해관계자 피드백 수집
3. [ ] Phase B 상세 설계

### 중기 목표 (1개월)
1. [ ] 모드별 분석 고도화 완료 (Phase B)
2. [ ] 결과물 형식 개선 (Phase C)
3. [ ] 사용자 테스트 및 피드백 반영

---

## 7. 부록

### 7.1 관련 문서
- [Phase 9-3 Todo List](../phases/phase-9-3/phase-9-3-todo-list.md)
- [Task 9-3-1 상세](../phases/phase-9-3/tasks/task-9-3-1-reasoning-recommendation.md)
- [개발 진행 가이드](../phases/phase-9-3/tasks/task-develop-guide.md)

### 7.2 기술 참고 자료
- Mermaid.js: https://mermaid.js.org/
- Chart.js: https://www.chartjs.org/
- Ollama API: https://ollama.ai/docs

### 7.3 용어 정의
| 용어 | 정의 |
|------|------|
| Reasoning | 지식 기반 AI 추론 분석 |
| Context | LLM에 전달되는 참조 정보 |
| Hybrid Search | 키워드 + 의미 검색 결합 |
| Reranking | 검색 결과 재정렬 |

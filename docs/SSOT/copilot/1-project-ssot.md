# 🔍 Multi-Agent SSOT: 프로젝트 개요 및 품질 기준

**작성일**: 2026-02-15
**역할**: GitHub Copilot (QA & Security Analyst) - 주도
**협업**: Cursor, Claude, Gemini와 함께 프로젝트 관리
**목적**: 프로젝트 현황, 품질 기준, 검증 기준을 모든 에이전트가 공유

---

## 1. 프로젝트 개요

### 1.1 프로젝트 정보

| 항목            | 내용                                 |
| --------------- | ------------------------------------ |
| **프로젝트명**  | Personal AI Brain Ver3               |
| **목적**        | 로컬 설치형 개인 AI 지식 관리 시스템 |
| **배포 형태**   | On-Premise (폐쇄망 동작)             |
| **대상 사용자** | 개인 사용자, 소규모 팀               |
| **라이센스**    | (프로젝트 정책에 따름)               |
| **현재 Phase**  | Phase 11 완료, Phase 11-5 진행 중    |

### 1.2 핵심 기능

| 영역          | 기능                                      | 상태                |
| ------------- | ----------------------------------------- | ------------------- |
| **지식 관리** | Markdown/PDF/DOCX 업로드 및 저장          | ✅ 완료 (Phase 3-6) |
| **검색**      | 하이브리드 검색 (의미 + 키워드)           | ✅ 완료 (Phase 2-4) |
| **AI 대화**   | Ollama 기반 질의응답                      | ✅ 완료 (Phase 5)   |
| **Reasoning** | 6가지 Role 기반 추론                      | ✅ 완료 (Phase 10)  |
| **Admin**     | 설정 관리 (템플릿, 프리셋, RAG 프로필 등) | ✅ 완료 (Phase 11)  |
| **보안**      | JWT 인증, Rate Limiting                   | ✅ 완료 (Phase 9-1) |
| **백업/복원** | DB·Qdrant 백업 및 복원                    | ✅ 완료 (Phase 9-4) |

### 1.3 현재 프로젝트 상태 (2026-02-15 기준)

| 지표                | 현황            | 목표      | 상태               |
| ------------------- | --------------- | --------- | ------------------ |
| **Backend API**     | 60+ 엔드포인트  | -         | ✅ 안정            |
| **Frontend 페이지** | 15+ HTML 페이지 | -         | ⚠️ CDN 의존성 문제 |
| **테스트 커버리지** | ~60% (추정)     | 80%       | 🔄 개선 필요       |
| **보안 점검**       | 90/100          | 95/100    | ✅ 양호            |
| **배포 가능 여부**  | 조건부 가능     | 즉시 가능 | ⚠️ CDN 제거 필요   |

---

## 2. 품질 기준 (Quality Standards)

### 2.1 코드 품질 기준

#### Backend (Python/FastAPI)

| 항목            | 기준                         | 도구 | 필수 여부 |
| --------------- | ---------------------------- | ---- | --------- |
| **타입 힌트**   | 모든 함수 파라미터 및 반환값 | mypy | ✅ 권장   |
| **코드 스타일** | PEP 8 준수                   | ruff | ✅ 필수   |
| **라인 길이**   | 최대 120자                   | ruff | ✅ 필수   |
| **함수 복잡도** | Cyclomatic Complexity ≤10    | -    | ✅ 권장   |
| **독스트링**    | 모든 public 함수/클래스      | -    | ✅ 필수   |

#### Frontend (JavaScript/HTML/CSS)

| 항목            | 기준                             | 도구      | 필수 여부   |
| --------------- | -------------------------------- | --------- | ----------- |
| **모듈화**      | ESM 순수 모듈 (전역 객체 최소화) | -         | ✅ 권장     |
| **JSDoc**       | 모든 export 함수                 | -         | ✅ 필수     |
| **코드 스타일** | Prettier 적용                    | prettier  | ✅ 필수     |
| **On-Premise**  | CDN 의존성 0개                   | 수동 검증 | ✅ **필수** |
| **보안**        | innerHTML 최소화, DOMPurify 사용 | 수동 검증 | ✅ 필수     |

### 2.2 테스트 품질 기준

#### Unit Test (pytest)

| 항목            | 기준                  | 목표 |
| --------------- | --------------------- | ---- |
| **커버리지**    | 핵심 로직 80% 이상    | 90%  |
| **테스트 격리** | SQLite 메모리 DB 사용 | 100% |
| **테스트 속도** | 전체 테스트 30초 이내 | 20초 |
| **픽스처 활용** | conftest.py 중앙 관리 | 100% |

#### Integration Test (pytest)

| 항목               | 기준                     | 목표 |
| ------------------ | ------------------------ | ---- |
| **API 엔드포인트** | 주요 엔드포인트 70% 이상 | 90%  |
| **DB 연동**        | 모든 CRUD 검증           | 100% |
| **에러 케이스**    | 4xx/5xx 응답 검증        | 100% |

#### E2E Test (Playwright)

| 항목                | 기준                      | 목표  |
| ------------------- | ------------------------- | ----- |
| **사용자 시나리오** | Phase당 10+ 시나리오      | 20+   |
| **브라우저**        | Chromium, Firefox, WebKit | 3개   |
| **화면 해상도**     | Desktop, Tablet, Mobile   | 3종류 |

### 2.3 보안 품질 기준

| 항목              | 기준            | 검증 방법                  | 필수 여부 |
| ----------------- | --------------- | -------------------------- | --------- |
| **SQL Injection** | 방어 100%       | ORM 사용 확인              | ✅ 필수   |
| **XSS**           | 방어 100%       | innerHTML 점검, DOMPurify  | ✅ 필수   |
| **CSRF**          | 방어 100%       | 토큰 검증                  | ✅ 필수   |
| **인증**          | JWT 검증        | 만료 시간, 토큰 블랙리스트 | ✅ 필수   |
| **Rate Limiting** | API별 제한 설정 | slowapi 설정 확인          | ✅ 필수   |
| **보안 헤더**     | 4개 헤더 설정   | middleware 확인            | ✅ 필수   |

### 2.4 성능 품질 기준

| 항목                 | 기준               | 측정 방법    |
| -------------------- | ------------------ | ------------ |
| **API 응답 시간**    | 평균 <500ms        | 프로파일링   |
| **검색 응답 시간**   | <1초 (1000건 기준) | 벤치마크     |
| **페이지 로드 시간** | <3초               | Lighthouse   |
| **메모리 사용량**    | Backend <512MB     | Docker stats |

---

## 3. 검증 기준 (Verification Criteria)

### 3.1 코드 리뷰 체크리스트

#### Backend

- [ ] **기능 구현**
  - [ ] 요구사항 충족 여부
  - [ ] API 명세 일치 여부
  - [ ] 에러 응답 표준 준수

- [ ] **코드 품질**
  - [ ] 타입 힌트 완성도
  - [ ] 독스트링 작성 여부
  - [ ] 함수 길이 (<50줄 권장)
  - [ ] 중복 코드 제거

- [ ] **보안**
  - [ ] 입력 검증 (Pydantic)
  - [ ] SQL Injection 방어
  - [ ] 권한 검증

- [ ] **테스트**
  - [ ] Unit Test 작성
  - [ ] 엣지 케이스 커버

#### Frontend

- [ ] **기능 구현**
  - [ ] UI/UX 요구사항 충족
  - [ ] API 연동 정상 동작
  - [ ] 에러 처리 구현

- [ ] **코드 품질**
  - [ ] ESM 모듈화
  - [ ] JSDoc 작성
  - [ ] 전역 객체 최소화

- [ ] **보안**
  - [ ] XSS 방어 (innerHTML 점검)
  - [ ] DOMPurify 적용
  - [ ] CDN 의존성 제거

- [ ] **접근성**
  - [ ] 키보드 네비게이션
  - [ ] ARIA 레이블
  - [ ] 반응형 디자인

### 3.2 테스트 검증 체크리스트

#### Unit Test

- [ ] **테스트 작성**
  - [ ] 정상 케이스
  - [ ] 엣지 케이스 (경계값, null, 빈 값)
  - [ ] 예외 케이스
  - [ ] Mock 활용 (외부 의존성)

- [ ] **테스트 품질**
  - [ ] Given-When-Then 구조
  - [ ] 테스트 이름 명확성
  - [ ] 단일 책임 (1 테스트 = 1 검증)

#### Integration Test

- [ ] **API 테스트**
  - [ ] 성공 응답 (200, 201, 204)
  - [ ] 클라이언트 에러 (400, 401, 403, 404)
  - [ ] 서버 에러 (500, 502, 503)
  - [ ] Rate Limiting (429)

- [ ] **DB 연동**
  - [ ] CRUD 전체 검증
  - [ ] 트랜잭션 롤백 확인
  - [ ] 외래키 제약조건 검증

#### E2E Test

- [ ] **사용자 시나리오**
  - [ ] 로그인 → 검색 → 결과 확인
  - [ ] 지식 생성 → 승인 → 검색
  - [ ] Reasoning 실행 → 결과 공유

- [ ] **브라우저 호환성**
  - [ ] Chromium 테스트
  - [ ] Firefox 테스트
  - [ ] WebKit 테스트

### 3.3 보안 검증 체크리스트

- [ ] **인증/인가**
  - [ ] 비인증 요청 거부 (401)
  - [ ] 권한 없는 요청 거부 (403)
  - [ ] 토큰 만료 시 재인증 요구
  - [ ] 토큰 블랙리스트 동작 확인

- [ ] **입력 검증**
  - [ ] SQL Injection 방어 (파라미터화)
  - [ ] XSS 방어 (이스케이프)
  - [ ] CSRF 토큰 검증
  - [ ] 파일 업로드 검증 (확장자, 크기)

- [ ] **보안 헤더**
  - [ ] X-Content-Type-Options
  - [ ] X-Frame-Options
  - [ ] X-XSS-Protection
  - [ ] Strict-Transport-Security (프로덕션)

- [ ] **Rate Limiting**
  - [ ] API별 제한 동작 확인
  - [ ] 429 응답 Retry-After 헤더 확인
  - [ ] 브루트포스 방어 (인증 API)

---

## 4. 배포 판정 기준

### 4.1 배포 차단 요소 (Blocker)

| 항목             | 기준                  | 현재 상태       |
| ---------------- | --------------------- | --------------- |
| **Critical Bug** | 0개                   | ✅ 0개          |
| **보안 취약점**  | 0개 (Critical/High)   | ✅ 0개          |
| **테스트 실패**  | 0개 (E2E)             | ✅ 통과         |
| **CDN 의존성**   | 0개 (On-Premise 필수) | ⚠️ **5개 발견** |

### 4.2 배포 권장 요소 (Recommended)

| 항목                | 기준               | 현재 상태    |
| ------------------- | ------------------ | ------------ |
| **테스트 커버리지** | ≥80%               | ⚠️ ~60%      |
| **타입 힌트**       | 100% (public 함수) | ⚠️ 88%       |
| **독스트링**        | 100% (public 함수) | ✅ 90%       |
| **보안 점검**       | A 등급 (90+)       | ✅ A- (90점) |

### 4.3 배포 판정 프로세스

```
┌──────────────────────────┐
│ 1. 코드 리뷰              │
│    모든 PR 승인 완료?     │
└──────┬───────────────────┘
       │ YES
       ▼
┌──────────────────────────┐
│ 2. 테스트 실행            │
│    Unit/Integration/E2E   │
└──────┬───────────────────┘
       │ 전체 통과
       ▼
┌──────────────────────────┐
│ 3. 보안 점검              │
│    체크리스트 완료?       │
└──────┬───────────────────┘
       │ 완료
       ▼
┌──────────────────────────┐
│ 4. 배포 차단 요소 확인    │
│    Blocker 0개?          │
└──────┬───────────────────┘
       │ 0개
       ▼
┌──────────────────────────┐
│ 5. 최종 판정              │
│    ✅ 배포 가능           │
│    📋 배포 체크리스트 작성│
└──────────────────────────┘
```

---

## 5. 협업 에이전트 역할 정의

### 5.1 각 에이전트의 책임 (Responsibility)

#### **Claude (Backend Engineer)**

| 책임 영역         | 구체적 활동             | 검증 항목 (Copilot)               |
| ----------------- | ----------------------- | --------------------------------- |
| **API 설계**      | RESTful 엔드포인트 정의 | ✅ 명세 일치도, 입력 검증         |
| **DB 관리**       | PostgreSQL 스키마 설계  | ✅ 인덱스, 제약조건, 마이그레이션 |
| **비즈니스 로직** | 서비스 레이어 구현      | ✅ 타입 힌트, 독스트링, 에러 처리 |
| **보안 구현**     | 입력 검증, 인증/인가    | ✅ SQL Injection, 권한 검증       |
| **문서화**        | API 문서, 스키마 주석   | ✅ JSDoc/Docstring 완성도         |
| **재작업**        | Copilot 피드백 반영     | ✅ 모든 이슈 해결 후 재제출       |

#### **Gemini (Frontend Architect)**

| 책임 영역       | 구체적 활동               | 검증 항목 (Copilot)           |
| --------------- | ------------------------- | ----------------------------- |
| **UI/UX 구현**  | HTML/CSS/Vanilla JS 개발  | ✅ 반응형, 접근성, 일관성     |
| **API 연동**    | fetch 기반 Backend 호출   | ✅ 에러 처리, 로딩 상태       |
| **보안 준수**   | XSS 방어, On-Premise 준수 | ✅ CDN 의존성, innerHTML 제거 |
| **성능 최적화** | 번들 크기, 페이지 속도    | ✅ Lighthouse, 로드 시간      |
| **문서화**      | JSDoc, 사용 설명서        | ✅ 함수 주석 완성도           |
| **재작업**      | Copilot 피드백 반영       | ✅ 모든 이슈 해결 후 재제출   |

#### **Copilot (QA & Security Analyst)**

| 책임 영역     | 구체적 활동                    | 산출물                     |
| ------------- | ------------------------------ | -------------------------- |
| **코드 리뷰** | Backend/Frontend 코드 검증     | ✅ 리뷰 보고서, 점수       |
| **보안 점검** | 취약점 스캔, 체크리스트        | ✅ 보안 보고서             |
| **테스트**    | Unit/Integration/E2E           | ✅ 테스트 보고서, 커버리지 |
| **배포 판정** | 품질 점수 계산, 배포 가능 여부 | ✅ 배포 판정 리포트        |
| **협업 중심** | 피드백 제공, 재작업 추적       | ✅ 협업 기록               |

#### **Cursor (Leader/오케스트라 리더)**

| 책임 영역       | 구체적 활동                  | 협업 대상      |
| --------------- | ---------------------------- | -------------- |
| **Phase 계획**  | 요구사항 수집, 아키텍처 결정 | 모든 에이전트  |
| **Task 할당**   | Claude/Gemini에게 업무 분배  | Claude, Gemini |
| **검증 피드백** | Copilot 리뷰 결과 반영       | Copilot        |
| **최종 배포**   | Copilot 검증 기반 배포 승인  | Copilot        |

### 5.2 협업 기준 (Quality Standards for Collaboration)

#### **Claude가 제출할 때 충족해야 할 기준**

```
✅ 요구사항:
   - 모든 API 엔드포인트 구현 완료
   - 자가 테스트: pytest 실행 후 모든 테스트 통과
   - Git commit 완료

✅ 코드 품질:
   - 타입 힌트: 모든 함수의 파라미터 & 반환값
   - 독스트링: 함수 설명, 파라미터, 반환값, 예외
   - PEP 8: ruff 검사 통과

✅ 보안:
   - SQLAlchemy ORM 사용 (원시 SQL 금지)
   - Pydantic 모델 검증 사용
   - 권한 검증: Depends() 사용

✅ 테스트:
   - Unit Test: 주요 함수별 3개 이상 시나리오
   - 엣지 케이스: 경계값, None, 빈 값 테스트
   - Coverage 목표: 70% 이상
```

#### **Gemini가 제출할 때 충족해야 할 기준**

```
✅ 요구사항:
   - 모든 UI/UX 페이지 구현 완료
   - 자가 테스트: 브라우저에서 모든 기능 동작 확인
   - Git commit 완료

✅ 코드 품질:
   - ESM 모듈: export/import 사용
   - JSDoc: 모든 export 함수에 주석
   - Prettier: 자동 포맷팅 적용

✅ 보안:
   - XSS 방어: innerHTML 사용 금지 (필요 시 DOMPurify)
   - CDN 의존성: 0개 (모든 라이브러리 로컬)
   - 입력 검증: 사용자 입력 sanitize

✅ 성능:
   - 번들 크기: 적절한 모듈 분할
   - 페이지 로드: <3초 목표
   - Lighthouse: 70+ 점수
```

### 5.3 협업 체크리스트

#### **Claude → Copilot 제출 체크리스트**

- [ ] Task 요구사항 100% 구현
- [ ] pytest 자가 테스트 모두 통과
- [ ] Git commit 완료
- [ ] 타입 힌트 완성도 90% 이상
- [ ] 보안 자가 점검 완료 (SQL Injection, 권한 검증)
- [ ] 에러 응답 형식 표준화 완료
- [ ] PR/Task 문서 준비 완료

#### **Gemini → Copilot 제출 체크리스트**

- [ ] Task 요구사항 100% 구현
- [ ] 모든 브라우저(Chrome, Firefox, Safari) 테스트 완료
- [ ] Git commit 완료
- [ ] JSDoc 작성 완료 (export 함수 100%)
- [ ] CDN 의존성 0개 확인
- [ ] innerHTML 사용 금지 (필요 시 DOMPurify)
- [ ] 반응형 디자인 확인 (모바일/태블릿/데스크톱)

---

## 6. Phase별 품질 현황

### 6.1 Phase 9 (보안 및 테스트)

| Task               | 상태    | 테스트  | 보안    | 품질 점수 |
| ------------------ | ------- | ------- | ------- | --------- |
| 9-1-1 (인증)       | ✅ DONE | ✅ 통과 | ✅ 통과 | 90/100    |
| 9-1-2 (보안 헤더)  | ✅ DONE | ✅ 통과 | ✅ 통과 | 85/100    |
| 9-1-3 (Rate Limit) | ✅ DONE | ✅ 통과 | ✅ 통과 | 88/100    |
| 9-4-1 (백업)       | ✅ DONE | ✅ 통과 | ✅ 통과 | 92/100    |

### 5.2 Phase 10 (Reasoning Lab)

| Task                  | 상태    | 테스트       | 보안    | 품질 점수 |
| --------------------- | ------- | ------------ | ------- | --------- |
| 10-1 (기본 Reasoning) | ✅ DONE | ✅ 통과      | ✅ 통과 | 85/100    |
| 10-2 (스트리밍)       | ✅ DONE | ✅ 통과      | ✅ 통과 | 82/100    |
| 10-3 (시각화)         | ✅ DONE | ⚠️ 부분 통과 | ✅ 통과 | 78/100    |
| 10-4 (공유 기능)      | ✅ DONE | ✅ 통과      | ✅ 통과 | 86/100    |

### 5.3 Phase 11 (Admin 설정)

| Task             | 상태    | 테스트        | 보안        | 품질 점수  |
| ---------------- | ------- | ------------- | ----------- | ---------- |
| 11-1 (DB 스키마) | ✅ DONE | ✅ 통과       | ✅ 통과     | 90/100     |
| 11-2 (API)       | ✅ DONE | ✅ 통과       | ✅ 통과     | 88/100     |
| 11-3 (UI)        | ✅ DONE | ⚠️ CDN 의존성 | ⚠️ XSS 위험 | **68/100** |

### 5.4 현재 우선순위 개선 사항

| 우선순위        | 개선 사항                 | 대상 Phase       | 예상 시간 |
| --------------- | ------------------------- | ---------------- | --------- |
| 🔴 **Critical** | CDN → 로컬 자산 변환      | Phase 11-3       | 2-3시간   |
| 🟠 **High**     | API 에러 응답 표준화      | 전체             | 4-6시간   |
| 🟠 **High**     | DB 인덱스 추가            | Phase 11         | 1시간     |
| 🟡 **Medium**   | 타입 힌트 보완            | Phase 9          | 2시간     |
| 🟡 **Medium**   | XSS 방어 강화 (DOMPurify) | Phase 10-3, 11-3 | 3시간     |

---

## 6. 협업 에이전트와의 품질 기준 공유

### 6.1 Claude (Backend)에게

> "API 에러 응답은 다음 형식으로 통일:
>
> ```json
> {
>   "success": false,
>   "error_code": "VALIDATION_ERROR",
>   "message": "사용자 친화적 메시지",
>   "details": {...}
> }
> ```
>
> DB 쿼리 최적화를 위해 다음 인덱스 추가 필요:
>
> - knowledge_chunks.content (GIN 인덱스)
> - conversations.session_id
> - memories.expires_at"

### 6.2 Gemini (Frontend)에게

> "**Critical Issue**: CDN 의존성 즉시 제거 필수.
> 다음 라이브러리를 `web/public/libs/`로 로컬화:
>
> - marked.js, chart.js, mermaid.js, html2canvas, jspdf
>
> XSS 방어 강화:
>
> - innerHTML 사용 최소화
> - DOMPurify 도입 및 적용
> - 전역 객체 의존성 제거, ESM 순수 모듈화"

### 6.3 Cursor (Leader)에게

> "**배포 판정**: 조건부 가능 (CDN 의존성 제거 필수)
>
> 현재 품질 점수: 78/100 (C+)
>
> - Backend: 82/100 (B)
> - Frontend: 68/100 (D+) ← **개선 필요**
> - 보안: 90/100 (A-)
>
> 배포 전 필수 조치:
>
> 1. CDN → 로컬 자산 (2-3시간)
> 2. API 에러 응답 표준화 (4-6시간)
> 3. DB 인덱스 추가 (1시간)
>
> 조치 완료 후 재검증 필요."

---

## 7. 참조 문서

| 문서                                                                                                                              | 역할                    |
| --------------------------------------------------------------------------------------------------------------------------------- | ----------------------- |
| [0-ssot-index.md](0-ssot-index.md)                                                                                                | SSOT 인덱스             |
| [2-architecture-ssot.md](2-architecture-ssot.md)                                                                                  | 아키텍처 및 보안 기준   |
| [3-workflow-ssot.md](3-workflow-ssot.md)                                                                                          | 워크플로우 및 검증 기준 |
| [copilot-comprehensive-multi-agent-review-260209-1645.md](../../overview/copilot-comprehensive-multi-agent-review-260209-1645.md) | 종합 리뷰 보고서        |

---

**다음 단계**: [2-architecture-ssot.md](2-architecture-ssot.md) 읽기 → 아키텍처 및 보안 기준 확인

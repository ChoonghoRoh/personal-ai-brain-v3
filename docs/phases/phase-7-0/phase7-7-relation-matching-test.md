# Phase 7.7 청크 관계 매칭 보드 테스트

## 테스트 목적

Phase 7.7에서 구현한 청크 관계 매칭 보드 UI의 기능을 검증합니다.

## 테스트 환경

- **날짜**: 2026-01-07
- **테스트 대상**: `/knowledge` (Knowledge Studio) 페이지
- **기능**: 청크 상세 관계 매칭 보드

## 테스트 시나리오

### 1. 청크 상세 열기 및 관계 매칭 탭 표시

**전제 조건:**
- Knowledge Studio 페이지 접근
- 최소 1개 이상의 청크 존재

**테스트 단계:**
1. Knowledge Studio 페이지 접근 (`/knowledge`)
2. 청크 카드 클릭하여 상세 정보 열기
3. "🔗 관계 매칭" 탭 확인

**예상 결과:**
- ✅ 청크 상세 정보가 표시됨
- ✅ "💡 라벨 매칭" 및 "🔗 관계 매칭" 탭이 표시됨
- ✅ "관계 매칭" 탭 클릭 시 관계 매칭 보드가 표시됨
- ✅ 3단 레이아웃이 표시됨 (좌측: 기준 청크, 중앙: 연결된 관계, 우측: 추천 관계)

---

### 2. 기준 청크 카드 표시

**전제 조건:**
- 청크 상세 정보가 열려 있음
- "관계 매칭" 탭이 활성화됨

**테스트 단계:**
1. "관계 매칭" 탭 클릭
2. 좌측 "기준 청크" 카드 확인

**예상 결과:**
- ✅ 기준 청크의 내용 미리보기가 표시됨 (200자 미리보기)
- ✅ 청크 메타데이터가 표시됨 (문서명, 청크 번호)

---

### 3. 연결된 관계 카드 표시

**전제 조건:**
- 청크 상세 정보가 열려 있음
- 해당 청크에 연결된 관계가 존재

**테스트 단계:**
1. "관계 매칭" 탭 클릭
2. 중앙 "연결된 관계" 섹션 확인
3. 관계 카드 정보 확인

**예상 결과:**
- ✅ 연결된 관계 목록이 카드 형태로 표시됨
- ✅ 각 카드에 다음 정보가 표시됨:
  - 관계 타입 배지
  - 확정 여부 배지 (✔ 확정 / ⏳ 제안)
  - 대상 청크 내용 미리보기
  - [해제] 버튼
- ✅ 관계가 없을 경우 "연결된 관계가 없습니다" 메시지 표시

---

### 4. 추천 관계 카드 표시

**전제 조건:**
- 청크 상세 정보가 열려 있음
- 해당 청크에 추천 가능한 관계가 존재

**테스트 단계:**
1. "관계 매칭" 탭 클릭
2. 우측 "추천 관계" 섹션 확인
3. 추천 관계 카드 정보 확인

**예상 결과:**
- ✅ 추천 관계 목록이 카드 형태로 표시됨
- ✅ 각 카드에 다음 정보가 표시됨:
  - 관계 타입 배지
  - 대상 청크 내용 미리보기
  - 유사도 점수 (퍼센트)
  - 유사도 점수 막대 그래프
  - [연결], [무시] 버튼
- ✅ 이미 연결된 관계는 "연결됨" 배지 표시 및 버튼 비활성화
- ✅ 추천 관계가 없을 경우 "추천 관계가 없습니다" 메시지 표시

---

### 5. 단일 관계 연결 기능

**전제 조건:**
- 청크 상세 정보가 열려 있음
- 추천 관계 목록에 연결 가능한 관계가 존재

**테스트 단계:**
1. 추천 관계 카드에서 [연결] 버튼 클릭
2. 성공 메시지 확인
3. 청크 상세 정보 새로고침 확인
4. 연결된 관계 섹션에 추가된 관계 확인

**예상 결과:**
- ✅ [연결] 버튼 클릭 시 API 호출 성공
- ✅ 성공 메시지 표시 ("관계가 연결되었습니다.")
- ✅ 청크 상세 정보가 자동으로 새로고침됨
- ✅ 연결된 관계가 "연결된 관계" 섹션에 추가됨
- ✅ 해당 추천 관계 카드가 "연결됨" 상태로 변경됨

---

### 6. 관계 무시 기능

**전제 조건:**
- 청크 상세 정보가 열려 있음
- 추천 관계 목록에 무시 가능한 관계가 존재

**테스트 단계:**
1. 추천 관계 카드에서 [무시] 버튼 클릭
2. 카드가 숨겨지는지 확인

**예상 결과:**
- ✅ [무시] 버튼 클릭 시 해당 카드가 즉시 숨겨짐
- ✅ 선택된 관계 목록에서 제거됨

---

### 7. 다중 선택 및 일괄 연결 기능

**전제 조건:**
- 청크 상세 정보가 열려 있음
- 추천 관계 목록에 연결 가능한 관계가 2개 이상 존재

**테스트 단계:**
1. 여러 추천 관계 카드 클릭하여 선택
2. 하단 요약 바 확인
3. [선택한 관계 연결] 버튼 클릭
4. 성공 메시지 확인

**예상 결과:**
- ✅ 카드 클릭 시 선택 상태 토글 (시각적 표시)
- ✅ 하단 요약 바에 선택된 관계 수 표시
- ✅ [선택한 관계 연결] 버튼 클릭 시 모든 선택된 관계가 일괄 연결됨
- ✅ 성공 메시지에 연결된 관계 수 표시

---

### 8. 관계 해제 기능

**전제 조건:**
- 청크 상세 정보가 열려 있음
- 연결된 관계가 최소 1개 이상 존재

**테스트 단계:**
1. "연결된 관계" 섹션에서 관계 카드의 [해제] 버튼 클릭
2. 확인 다이얼로그에서 확인 클릭
3. 관계 해제 확인
4. 청크 상세 정보 새로고침 확인

**예상 결과:**
- ✅ [해제] 버튼 클릭 시 확인 다이얼로그 표시
- ✅ 확인 시 API 호출 성공
- ✅ 성공 메시지 표시 ("관계가 해제되었습니다.")
- ✅ 청크 상세 정보가 자동으로 새로고침됨
- ✅ 해제된 관계가 "연결된 관계" 섹션에서 제거됨

---

### 9. 탭 전환 동작

**전제 조건:**
- 청크 상세 정보가 열려 있음

**테스트 단계:**
1. "라벨 매칭" 탭 클릭
2. "관계 매칭" 탭 클릭
3. 다시 "라벨 매칭" 탭 클릭

**예상 결과:**
- ✅ 탭 클릭 시 활성 탭이 변경됨 (시각적 표시)
- ✅ 각 탭의 컨텐츠가 정상적으로 표시/숨김됨
- ✅ "관계 매칭" 탭으로 전환 시 추천 관계가 자동으로 로드됨

---

### 10. API 오류 처리

**전제 조건:**
- 청크 상세 정보가 열려 있음
- 네트워크 오류 또는 서버 오류 상황 시뮬레이션

**테스트 단계:**
1. 네트워크 연결 끊기 (또는 서버 중지)
2. 추천 관계 로드 시도
3. 관계 연결/해제 시도

**예상 결과:**
- ✅ 오류 메시지가 적절히 표시됨
- ✅ 사용자에게 친화적인 오류 메시지 제공
- ✅ 콘솔에 상세 오류 로그 기록

---

## 테스트 결과 요약

### 성공 기준

- ✅ 모든 기본 기능이 정상 동작
- ✅ UI/UX가 직관적이고 사용하기 쉬움
- ✅ 오류 처리가 적절함
- ✅ 성능이 허용 가능한 수준 (로딩 시간 < 2초)

### 발견된 이슈

(테스트 수행 후 기록)

---

## 테스트 수행 방법

1. 웹 서버 실행 확인
2. 브라우저에서 `/knowledge` 페이지 접근
3. 위 시나리오를 순차적으로 수행
4. 각 시나리오의 결과를 기록
5. 발견된 이슈를 문서화

---

## 참고

- API 엔드포인트:
  - `GET /api/knowledge/chunks/{chunk_id}` - 청크 상세 정보
  - `POST /api/knowledge/relations/suggest?chunk_id={chunk_id}&limit={limit}` - 추천 관계 조회
  - `POST /api/knowledge/relations/suggest/{chunk_id}/apply?target_chunk_id={target_chunk_id}&relation_type={type}&score={score}` - 관계 연결
  - `DELETE /api/relations/{relation_id}` - 관계 해제


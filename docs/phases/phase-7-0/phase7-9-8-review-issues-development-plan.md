# Phase 7.9.8: 처리 안된 부분 개발 계획서

**작성일**: 2026-01-10  
**상태**: 📋 계획 단계 (컨펌 대기)

---

## 📋 처리 원칙

1. **순차 개발**: 우선순위 중간부터 시작하여 단계별 진행
2. **루프 오류 처리**: 5회 이상 반복 오류 발생 시 오류 사항 기록 후 다음 단계로 이동
3. **파일 분기**: 수정할 파일이 1000줄을 넘을 경우 개발 문서를 분기하여 작성
4. **단계별 검증**: 각 단계 완료 후 검증 및 문서화

---

## 📊 To-Do List

### 우선순위 중간 (즉시 처리)

| ID  | 항목             | 우선순위 | 예상 소요 | 상태    |
| --- | ---------------- | -------- | --------- | ------- |
| 1   | 페이징 기능 추가 | 🟡 중간  | 3-5일     | 📋 계획 |
| 2   | 대화 기록 저장   | 🟡 중간  | 1-2일     | 📋 계획 |
| 3   | 라벨 삭제 확인   | 🟡 중간  | 0.5-1일   | 📋 계획 |

### 우선순위 낮음 (선택적)

| ID  | 항목           | 우선순위 | 예상 소요 | 상태    |
| --- | -------------- | -------- | --------- | ------- |
| 4   | 검색 기능 개선 | 🟢 낮음  | 2-3일     | 📋 계획 |
| 5   | 정렬 옵션 추가 | 🟢 낮음  | 2-3일     | 📋 계획 |
| 6   | 일괄 작업 기능 | 🟢 낮음  | 2-3일     | 📋 계획 |
| 7   | 거절 사유 입력 | 🟢 낮음  | 1-2일     | 📋 계획 |
| 8   | 로그 내보내기  | 🟢 낮음  | 1-2일     | 📋 계획 |
| 9   | 답변 스트리밍  | 🟢 낮음  | 3-5일     | 📋 계획 |
| 10  | 결과 저장/공유 | 🟢 낮음  | 2-3일     | 📋 계획 |

---

## 🎯 단계별 순차 개발 계획

### 1단계: 페이징 기능 추가

**우선순위**: 🟡 중간  
**예상 소요 시간**: 3-5일  
**영향 범위**: 4개 페이지, 3개 백엔드 라우터

#### Step 1-1: 백엔드 API 개선

**대상 파일**:

- `backend/routers/knowledge.py` (470줄) ✅ 1000줄 미만
- `backend/routers/approval.py` (확인 필요)
- `backend/routers/logs.py` (110줄) ✅ 1000줄 미만

**작업 내용**:

1. `offset`, `limit` 파라미터 지원 확인 및 개선
2. 총 개수(`total_count`) 반환 추가
3. 페이징 메타데이터 반환 (현재 페이지, 총 페이지 수 등)

**예상 수정 라인**: 각 파일 20-50줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 `docs/dev/phase7-9-8-review-issues-development-plan-step1-errors.md`에 기록
- 다음 Step으로 이동

---

#### Step 1-2: 프론트엔드 - knowledge.js

**대상 파일**:

- `web/public/js/knowledge.js` (227줄) ✅ 1000줄 미만

**작업 내용**:

1. 페이징 UI 컴포넌트 추가 (페이지 번호, 이전/다음 버튼)
2. 페이지당 항목 수 선택 드롭다운
3. `loadChunks()` 함수에 `offset`, `limit` 파라미터 추가
4. 총 개수 표시
5. URL 파라미터로 페이지 상태 유지

**예상 수정 라인**: 100-150줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 1-3으로 이동

---

#### Step 1-3: 프론트엔드 - admin-approval.js

**대상 파일**:

- `web/public/js/admin-approval.js` (331줄) ✅ 1000줄 미만

**작업 내용**:

1. 페이징 UI 컴포넌트 추가
2. `loadPendingChunks()` 함수에 페이징 로직 추가
3. 상태 필터와 페이징 연동

**예상 수정 라인**: 80-120줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 1-4로 이동

---

#### Step 1-4: 프론트엔드 - logs.js

**대상 파일**:

- `web/public/js/logs.js` (184줄) ✅ 1000줄 미만

**작업 내용**:

1. 페이징 UI 컴포넌트 추가
2. `loadLogs()` 함수에 페이징 로직 추가
3. 날짜 필터와 페이징 연동

**예상 수정 라인**: 60-100줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 1-5로 이동

---

#### Step 1-5: 프론트엔드 - admin-labels.js (청크 검색 결과)

**대상 파일**:

- `web/public/js/admin-labels.js` (288줄) ✅ 1000줄 미만

**작업 내용**:

1. 청크 검색 결과에 페이징 추가
2. 검색과 페이징 연동

**예상 수정 라인**: 50-80줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 2단계로 이동

---

#### Step 1-6: 공통 페이징 컴포넌트 생성 (선택적)

**대상 파일**:

- `web/public/js/pagination-component.js` (신규 생성)

**작업 내용**:

1. 재사용 가능한 페이징 컴포넌트 함수 생성
2. 각 페이지에서 공통 컴포넌트 사용하도록 리팩토링

**예상 수정 라인**: 100-150줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 2단계로 이동

---

### 2단계: 대화 기록 저장

**우선순위**: 🟡 중간  
**예상 소요 시간**: 1-2일  
**영향 범위**: 1개 페이지

#### Step 2-1: 로컬 스토리지 저장 기능

**대상 파일**:

- `web/public/js/ask.js` (125줄) ✅ 1000줄 미만

**작업 내용**:

1. 대화 기록을 로컬 스토리지에 저장하는 함수 추가
2. 페이지 로드 시 저장된 대화 기록 복원
3. 대화 기록 내보내기 기능 (JSON, Markdown)
4. 대화 기록 삭제 기능

**예상 수정 라인**: 80-120줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 3단계로 이동

---

### 3단계: 라벨 삭제 확인

**우선순위**: 🟡 중간  
**예상 소요 시간**: 0.5-1일  
**영향 범위**: 2개 페이지

#### Step 3-1: admin-labels.js - 라벨 삭제 확인

**대상 파일**:

- `web/public/js/admin-labels.js` (288줄) ✅ 1000줄 미만

**작업 내용**:

1. 삭제 전 확인 다이얼로그 추가
2. 삭제 전 영향도 조회 (해당 라벨이 붙은 청크 수)
3. 영향도 정보를 다이얼로그에 표시
4. 삭제 취소 불가능 경고 표시

**예상 수정 라인**: 50-80줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 3-2로 이동

---

#### Step 3-2: admin-groups.js - 그룹 삭제 확인

**대상 파일**:

- `web/public/js/admin-groups.js` (1043줄) ⚠️ **1000줄 초과**

**파일 분기 계획**:

- 파일이 1000줄을 넘으므로 수정 내용이 많을 경우 `docs/dev/phase7-9-8-review-issues-development-plan-step3-2-groups.md` 문서 분기

**작업 내용**:

1. 삭제 전 확인 다이얼로그 추가
2. 삭제 전 영향도 조회 (해당 그룹에 속한 키워드 수)
3. 영향도 정보를 다이얼로그에 표시
4. 삭제 취소 불가능 경고 표시

**예상 수정 라인**: 50-80줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 4단계로 이동

---

### 4단계: 검색 기능 개선 (우선순위 낮음)

**우선순위**: 🟢 낮음  
**예상 소요 시간**: 2-3일  
**영향 범위**: 3개 페이지

#### Step 4-1: knowledge.js - 청크 내용 검색

**대상 파일**:

- `web/public/js/knowledge.js` (227줄) ✅ 1000줄 미만

**작업 내용**:

1. 검색 입력 필드 추가
2. 청크 내용 검색 API 호출
3. 검색 결과 하이라이팅

**예상 수정 라인**: 60-100줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 4-2로 이동

---

#### Step 4-2: admin-labels.js - 고급 검색 옵션

**대상 파일**:

- `web/public/js/admin-labels.js` (288줄) ✅ 1000줄 미만

**작업 내용**:

1. 고급 검색 UI 추가 (정규식, 복합 조건)
2. 검색 옵션 파라미터 추가
3. 검색 결과 필터링

**예상 수정 라인**: 80-120줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 4-3로 이동

---

#### Step 4-3: logs.js - 고급 검색 옵션

**대상 파일**:

- `web/public/js/logs.js` (184줄) ✅ 1000줄 미만

**작업 내용**:

1. 고급 검색 UI 추가
2. 로그 레벨, 타입별 필터링
3. 날짜 범위 검색

**예상 수정 라인**: 60-100줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 5단계로 이동

---

### 5단계: 정렬 옵션 추가 (우선순위 낮음)

**우선순위**: 🟢 낮음  
**예상 소요 시간**: 2-3일  
**영향 범위**: 4개 페이지

#### Step 5-1: knowledge.js - 정렬 옵션

**대상 파일**:

- `web/public/js/knowledge.js` (227줄) ✅ 1000줄 미만

**작업 내용**:

1. 정렬 드롭다운 추가 (날짜순, 이름순, 관계 수순)
2. 정렬 파라미터를 API에 전달
3. 정렬 방향 토글 (오름차순/내림차순)

**예상 수정 라인**: 50-80줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 5-2로 이동

---

#### Step 5-2: admin-approval.js - 정렬 옵션

**대상 파일**:

- `web/public/js/admin-approval.js` (331줄) ✅ 1000줄 미만

**작업 내용**:

1. 정렬 드롭다운 추가
2. 정렬 파라미터 전달

**예상 수정 라인**: 40-70줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 5-3로 이동

---

#### Step 5-3: logs.js - 정렬 옵션

**대상 파일**:

- `web/public/js/logs.js` (184줄) ✅ 1000줄 미만

**작업 내용**:

1. 정렬 드롭다운 추가
2. 정렬 파라미터 전달

**예상 수정 라인**: 40-70줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 5-4로 이동

---

#### Step 5-4: search.js - 검색 결과 정렬

**대상 파일**:

- `web/public/js/search.js` (확인 필요)

**작업 내용**:

1. 유사도순 정렬 옵션 추가
2. 정렬 파라미터 전달

**예상 수정 라인**: 30-60줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 6단계로 이동

---

### 6단계: 일괄 작업 기능 (우선순위 낮음)

**우선순위**: 🟢 낮음  
**예상 소요 시간**: 2-3일  
**영향 범위**: 3개 페이지

#### Step 6-1: admin-approval.js - 일괄 승인/거절

**대상 파일**:

- `web/public/js/admin-approval.js` (331줄) ✅ 1000줄 미만

**작업 내용**:

1. 체크박스 선택 기능 추가
2. 전체 선택/해제 기능
3. 선택한 항목 일괄 승인/거절 API 호출
4. 진행 상태 표시 (진행률, 성공/실패 개수)

**예상 수정 라인**: 100-150줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 6-2로 이동

---

#### Step 6-2: admin-labels.js - 여러 청크에 동시 라벨 추가

**대상 파일**:

- `web/public/js/admin-labels.js` (288줄) ✅ 1000줄 미만

**작업 내용**:

1. 체크박스 선택 기능 추가
2. 선택한 청크에 일괄 라벨 추가 API 호출
3. 진행 상태 표시

**예상 수정 라인**: 80-120줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 6-3로 이동

---

#### Step 6-3: admin-groups.js - 키워드 일괄 연결 개선

**대상 파일**:

- `web/public/js/admin-groups.js` (1043줄) ⚠️ **1000줄 초과**

**파일 분기 계획**:

- 파일이 1000줄을 넘으므로 수정 내용이 많을 경우 `docs/dev/phase7-9-8-review-issues-development-plan-step6-3-groups.md` 문서 분기

**작업 내용**:

1. 기존 일괄 연결 기능 개선
2. 진행 상태 표시 개선
3. 오류 처리 개선

**예상 수정 라인**: 50-100줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 7단계로 이동

---

### 7단계: 거절 사유 입력 (우선순위 낮음)

**우선순위**: 🟢 낮음  
**예상 소요 시간**: 1-2일  
**영향 범위**: 1개 페이지

#### Step 7-1: admin-approval.js - 거절 사유 입력

**대상 파일**:

- `web/public/js/admin-approval.js` (331줄) ✅ 1000줄 미만

**작업 내용**:

1. 거절 시 사유 입력 모달 추가
2. 거절 사유 저장 API 수정
3. 거절 사유 표시 (거절된 청크 상세에서)
4. 거절 사유 통계 (선택적)

**예상 수정 라인**: 80-120줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 8단계로 이동

---

### 8단계: 로그 내보내기 (우선순위 낮음)

**우선순위**: 🟢 낮음  
**예상 소요 시간**: 1-2일  
**영향 범위**: 1개 페이지

#### Step 8-1: logs.js - 로그 내보내기

**대상 파일**:

- `web/public/js/logs.js` (184줄) ✅ 1000줄 미만

**작업 내용**:

1. 내보내기 버튼 추가
2. CSV 형태로 내보내기
3. JSON 형태로 내보내기
4. Markdown 형태로 내보내기 (선택적)

**예상 수정 라인**: 60-100줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 9단계로 이동

---

### 9단계: 답변 스트리밍 (우선순위 낮음)

**우선순위**: 🟢 낮음  
**예상 소요 시간**: 3-5일  
**영향 범위**: 2개 페이지

#### Step 9-1: ask.js - AI 질의 스트리밍

**대상 파일**:

- `web/public/js/ask.js` (125줄) ✅ 1000줄 미만

**작업 내용**:

1. 백엔드: 스트리밍 응답 지원 (Server-Sent Events 또는 WebSocket)
2. 프론트엔드: 스트리밍 응답 수신 및 실시간 표시
3. 진행 상태 표시

**예상 수정 라인**: 100-150줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 9-2로 이동

---

#### Step 9-2: reason.js - Reasoning 스트리밍

**대상 파일**:

- `web/public/js/reason.js` (확인 필요)

**작업 내용**:

1. 백엔드: 스트리밍 응답 지원
2. 프론트엔드: 스트리밍 응답 수신 및 실시간 표시
3. 진행 상태 표시

**예상 수정 라인**: 100-150줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 10단계로 이동

---

### 10단계: 결과 저장/공유 (우선순위 낮음)

**우선순위**: 🟢 낮음  
**예상 소요 시간**: 2-3일  
**영향 범위**: 2개 페이지

#### Step 10-1: reason.js - Reasoning 결과 저장/공유

**대상 파일**:

- `web/public/js/reason.js` (확인 필요)

**작업 내용**:

1. 결과 저장 기능 (로컬 스토리지 또는 서버)
2. 결과 공유 기능 (링크 생성)
3. 결과 히스토리 조회

**예상 수정 라인**: 80-120줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 Step 10-2로 이동

---

#### Step 10-2: ask.js - AI 질의 답변 저장/공유

**대상 파일**:

- `web/public/js/ask.js` (125줄) ✅ 1000줄 미만

**작업 내용**:

1. 답변 저장 기능
2. 답변 공유 기능 (링크 생성)
3. 답변 히스토리 조회

**예상 수정 라인**: 80-120줄

**루프 오류 처리**:

- 5회 이상 반복 오류 발생 시 오류 기록 후 완료

---

## 📝 파일 분기 계획

### 1000줄 초과 파일

다음 파일들은 1000줄을 넘으므로, 수정 내용이 많을 경우 별도 문서로 분기:

1. **`web/public/js/admin-groups.js`** (1043줄)

   - 3단계 Step 3-2: `docs/dev/phase7-9-8-review-issues-development-plan-step3-2-groups.md`
   - 6단계 Step 6-3: `docs/dev/phase7-9-8-review-issues-development-plan-step6-3-groups.md`

2. **`web/public/js/knowledge-admin.js`** (1446줄)
   - 현재 계획에는 포함되지 않지만, 향후 수정 시 분기 필요

### 분기 문서 작성 기준

- 파일 수정 라인이 200줄 이상일 경우
- 복잡한 로직 변경이 포함될 경우
- 여러 기능을 동시에 수정할 경우

---

## ⚠️ 루프 오류 처리 규칙

### 오류 카운터 관리

각 Step에서 동일한 오류가 5회 이상 반복 발생 시:

1. **오류 기록**: `docs/dev/phase7-9-8-review-issues-development-plan-step{N}-errors.md` 파일에 기록
2. **오류 내용**:
   - 오류 유형
   - 발생 위치 (파일, 함수, 라인)
   - 오류 메시지
   - 시도 횟수
   - 해결 시도 내용
3. **다음 단계 이동**: 현재 Step을 건너뛰고 다음 Step으로 이동
4. **최종 정리**: 모든 단계 완료 후 루프 오류 부분 별도 처리

### 오류 기록 형식

```markdown
## 루프 오류 기록

### Step {N}-{M}: {기능명}

**오류 유형**: {오류 유형}
**발생 위치**: {파일명}:{함수명}:{라인번호}
**시도 횟수**: {N}회
**오류 메시지**: {오류 메시지}
**해결 시도**: {시도한 해결 방법}
**상태**: ⏸️ 보류 (다음 단계로 이동)
```

---

## 📊 진행 상황 추적

### 단계별 체크리스트

각 Step 완료 후 다음 항목 확인:

- [ ] 코드 수정 완료
- [ ] 테스트 완료
- [ ] 문서 업데이트
- [ ] 린터 오류 없음
- [ ] 루프 오류 없음 (또는 기록 완료)

### 진행 상황 문서

각 단계별로 `docs/dev/phase7-9-8-review-issues-development-progress.md`에 진행 상황 기록:

- 시작 시간
- 완료 시간
- 수정된 파일 목록
- 수정 라인 수
- 발생한 오류 (있는 경우)
- 다음 단계 계획

---

## 🎯 우선순위별 일정

### Phase 1: 우선순위 중간 (1-3단계)

**예상 기간**: 5-8일

1. 1단계: 페이징 기능 (3-5일)
2. 2단계: 대화 기록 저장 (1-2일)
3. 3단계: 라벨 삭제 확인 (0.5-1일)

### Phase 2: 우선순위 낮음 (4-10단계)

**예상 기간**: 15-25일 (선택적)

4. 4단계: 검색 기능 개선 (2-3일)
5. 5단계: 정렬 옵션 추가 (2-3일)
6. 6단계: 일괄 작업 기능 (2-3일)
7. 7단계: 거절 사유 입력 (1-2일)
8. 8단계: 로그 내보내기 (1-2일)
9. 9단계: 답변 스트리밍 (3-5일)
10. 10단계: 결과 저장/공유 (2-3일)

---

## ✅ 검증 기준

### 각 단계 완료 기준

1. **기능 동작**: 요구사항에 맞게 기능이 정상 동작
2. **오류 없음**: 린터 오류, 런타임 오류 없음
3. **문서화**: 수정 내역이 문서에 기록됨
4. **테스트**: 기본 기능 테스트 완료

### 최종 완료 기준

1. Phase 1 (우선순위 중간) 모든 단계 완료
2. 루프 오류 기록 완료 (있는 경우)
3. 최종 문서 정리 완료

---

## 📚 관련 문서

- [처리 안된 부분 정리](./phase7-9-8-review-issues-unhandled.md)
- [오류 수정 진행 상황](./phase7-9-8-review-error-fix-progress.md)
- [오류 수정 완료 요약](./phase7-9-8-review-error-fix-summary.md)

---

## 🔄 계획 업데이트

이 계획서는 개발 진행에 따라 업데이트됩니다:

- 각 단계 완료 시 진행 상황 반영
- 루프 오류 발생 시 오류 기록 추가
- 일정 변경 시 예상 소요 시간 업데이트

---

**다음 단계**: 계획 컨펌 후 1단계 Step 1-1부터 시작

# Task 18-1-5: 연관 키워드 API

- **우선순위**: P0
- **의존성**: 없음
- **담당 팀원**: backend-dev
- **상태**: PENDING

## §1 목적

그룹의 연관 키워드를 ILIKE 텍스트 검색 + Qdrant 유사도 결합으로 조회하는 API를 생성한다.

## §2 변경 범위

| 파일 | 변경 유형 |
|------|----------|
| `backend/routers/knowledge/labels.py` | 신규 엔드포인트 추가 |
| `backend/routers/knowledge/labels_crud.py` | 연관 키워드 핸들러 추가 |

## §3 구현 상세

### API 스펙
```
GET /api/labels/groups/{group_id}/related-keywords?q={query}&limit=20
```

### 응답 형식
```json
{
  "items": [
    {"id": 1, "name": "딥러닝", "similarity_score": 0.87, "source": "qdrant"},
    {"id": 2, "name": "CNN", "similarity_score": 0.76, "source": "text"}
  ],
  "total": 15
}
```

### 로직
1. 그룹 소속 키워드 ID 목록 조회 → 제외 목록
2. ILIKE 텍스트 검색: `Label.name.ilike(f"%{q}%")` (q가 있을 때)
3. Qdrant 유사도 검색: 그룹 description 또는 키워드 이름 기반 벡터 검색 (가능한 경우)
4. 두 결과를 병합하고 중복 제거, similarity_score 기준 정렬
5. 상위 limit개 반환

### Qdrant 사용 가능 여부 확인
- Qdrant 연결이 불가능하면 ILIKE 검색만 수행 (graceful fallback)
- similarity_score: Qdrant 결과는 실제 점수, ILIKE 결과는 0.5 (기본값)

## §4 완료 기준

- [ ] API 엔드포인트 동작
- [ ] 그룹 소속 키워드 제외
- [ ] ILIKE 검색 동작
- [ ] Qdrant 미연결 시 fallback 동작
- [ ] 응답 형식 준수

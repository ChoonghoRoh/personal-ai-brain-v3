# Task 19-3-3: 클릭 즉시 피드백 + 노드 이동 성능

> **우선순위**: P1
> **의존성**: 19-3-2 (D&D 제거 완료 후)
> **담당**: frontend-dev
> **상태**: PLANNED

---

## §1 목표

노드 선택/이동 시 즉각적인 시각 피드백 제공.
낙관적 UI로 API 응답 대기 시간 동안 사용자 체감 지연 제거.

## §2 대상 파일 및 변경 범위

| 파일 | 변경 유형 |
|------|----------|
| `web/public/js/admin/keyword-group-treeview.js` | **수정** (moveNode 낙관적 UI, 스피너) |
| `web/public/css/admin/admin-groups-tree.css` | **수정** (스피너 CSS 추가) |

## §3 구현 상세

### 3.1 선택 즉시 피드백

`selectNode()` L256~263에서 DOM 직접 `.selected` 토글 — 이미 부분 구현됨.
추가 개선: 선택 시 스크롤 위치로 자동 이동 (`scrollIntoView`).

### 3.2 노드 이동 스피너

```javascript
async moveNode(sourceId, targetId) {
  var sourceEl = document.querySelector('[data-node-id="' + sourceId + '"] > .tree-node-content');
  if (sourceEl) sourceEl.classList.add("loading");
  try {
    // 기존 API 호출
  } finally {
    if (sourceEl) sourceEl.classList.remove("loading");
  }
}
```

CSS:
```css
.tree-node-content.loading { opacity: 0.6; pointer-events: none; }
.tree-node-content.loading::after {
  content: ""; display: inline-block; width: 12px; height: 12px;
  border: 2px solid #e5e7eb; border-top-color: #2563eb;
  border-radius: 50%; animation: spin 0.6s linear infinite; margin-left: 8px;
}
@keyframes spin { to { transform: rotate(360deg); } }
```

### 3.3 낙관적 UI (moveNode)

1. `JSON.parse(JSON.stringify(this.treeData))`로 딥카피 백업
2. `_moveNodeLocal(sourceId, targetId)`로 클라이언트 즉시 이동 + 렌더링
3. API 호출 → 성공 시 완료, 실패 시 백업 복구 + 에러 토스트

`_moveNodeLocal()`: treeData에서 sourceId 노드 제거 → targetId 하위로 삽입

## §4 완료 기준 (Done Definition)

1. 노드 선택 시 `.selected` 클래스 즉시 적용 (렌더링 대기 없음)
2. 노드 이동 시 스피너 표시 → 완료/실패 시 제거
3. 낙관적 UI: 이동 즉시 트리 업데이트, API 실패 시 원래 상태 복구
4. 에러 발생 시 사용자에게 토스트 메시지 표시

# Phase 19-3 Plan: 키워드 그룹 관리 UI 리뉴얼

> **Phase**: 19-3
> **상태**: PLANNED
> **작성일**: 2026-02-22
> **Master Plan**: [phase-19-master-plan.md](../phase-19-master-plan.md)
> **선행 Phase**: 19-1 (키워드 추천 엔진 고도화) — DONE

---

## 1. 배경

현재 키워드 그룹 관리 화면(`/admin/groups`)의 UX 문제:
1. D&D(드래그&드롭) 거의 미사용 + 모바일 미지원
2. 노드 클릭/이동 시 시각적 피드백 없음
3. 상세 → 수정 2단계 진입 (뎁스 낭비)
4. 트리 헤더/검색 분산 배치
5. `admin-groups.css`(975줄) Lv2 리팩토링 대상 (REFACTOR-2)

---

## 2. 목표

- CSS Lv2 리팩토링: 975줄 단일 파일 → 기능별 5개 파일 분리 (각 500줄 미만)
- D&D 전면 제거 → 폴더형 아이콘 트리 전환, 우클릭 메뉴로 이동 기능 대체
- 클릭 즉시 피드백 + 낙관적 UI로 체감 성능 향상
- 바로 수정 모드: 그룹 선택 즉시 인라인 편집 폼 표시
- 트리 헤더에 검색+깊이 필터 컴팩트 통합
- `keyword-group-crud.js` 구조 정리 (546줄 → 500줄 미만)

---

## 3. 코드 분석 결과

### 파일별 현황

| 파일 | 줄 수 | 비고 |
|------|------:|------|
| `admin-groups.css` | **975줄** | Master Plan 805줄 대비 170줄 증가 |
| `keyword-group-treeview.js` | 567줄 | D&D 코드 76줄 |
| `keyword-group-crud.js` | 546줄 | 중복 HTML 50줄+ |
| `keyword-group-matching.js` | 557줄 | 키워드 섹션 렌더링 |
| `keyword-group-ui.js` | 145줄 | UI 상태 |
| `keyword-group-manager.js` | 88줄 | 위임 패턴 |
| `keyword-group-suggestion.js` | 342줄 | LLM 추천 |
| `keyword-group-search.js` | 31줄 | 검색 |
| `admin-groups.js` | 169줄 | 엔트리포인트 |
| `groups.html` | 119줄 | HTML |

### admin-groups.css 기능 블록 분포

| 블록 | 줄 범위 | 줄 수 | 분류 |
|------|---------|------:|------|
| 페이지 헤더 | 1~25 | 25 | base |
| 검색 바 | 26~61 | 36 | base |
| kg-explorer 레이아웃 | 63~168 | 106 | base |
| 레거시 3단 레이아웃 | 170~221 | 52 | base (삭제) |
| 그룹 상세 패널 | 223~366 | 144 | panel |
| 키워드 섹션/배지/페이지네이션 | 368~716 | 349 | keywords |
| 하단 요약 바 | 718~782 | 65 | panel |
| 탭 네비게이션 | 784~814 | 31 | base |
| 트리뷰 | 816~953 | 138 | tree |
| 반응형 | 955~975 | 21 | responsive |

---

## 4. Task별 상세 계획

### Task 19-3-1: CSS 분리 (Lv2 리팩토링) [선행]
- 975줄 → 5개 파일: base(~160), tree(~140), panel(~210), keywords(~350), responsive(~25)
- 레거시 3단 레이아웃(52줄) 제거
- groups.html CSS 링크 1개 → 5개

### Task 19-3-2: D&D 제거 + 폴더형 트리 전환
- D&D 코드 76줄 제거 (JS) + 관련 CSS 스타일 제거
- 폴더 아이콘 (📁/📂) + 우클릭 메뉴 "부모 변경" 추가
- treeview.js: 567줄 → ~510줄 (500줄 근접, 초과 시 컨텍스트 메뉴 분리)

### Task 19-3-3: 클릭 즉시 피드백 + 노드 이동 성능
- `.selected` 즉시 적용 + 스피너 + 낙관적 UI(백업/복구)

### Task 19-3-4: 바로 수정 모드
- 공통 HTML `_buildEditFormHTML()` 추출로 중복 제거
- 보기 모드 제거 → 선택 즉시 편집 폼
- crud.js: 546줄 → ~497줄 (레거시 래퍼 제거 포함)

### Task 19-3-5: 트리 헤더 + 검색 통합
- `groups-search-bar` → `kg-tree-header` 내부로 이동
- 깊이 필터도 트리 헤더로 통합

### Task 19-3-6: 회귀 테스트
- 트리 렌더링, 노드 이동, CRUD, 검색, 반응형, 500줄 규정 확인

---

## 5. 의존성 순서

```
19-3-1 (CSS 분리) ──→ 19-3-2 (D&D 제거 + 폴더형)
                         │
                         ├──→ 19-3-3 (클릭 피드백)
                         │
                         └──→ 19-3-4 (바로 수정)
                                │
                                └──→ 19-3-5 (트리 헤더 + 검색)
                                        │
                                        └──→ 19-3-6 (회귀 테스트)
```

---

## 6. 리스크

| 리스크 | 심각도 | 대응 |
|--------|:------:|------|
| CSS 분리 후 스타일 깨짐 | 높음 | 분리 후 즉시 브라우저 확인 |
| D&D 제거 후 이동 UX 퇴보 | 높음 | 우클릭 + 드롭다운 2가지 경로 |
| 낙관적 UI 실패 시 불일치 | 높음 | 딥카피 백업 + 서버 재조회 |
| crud.js 500줄 초과 | 중간 | 레거시 래퍼 + 미사용 메서드 제거 |
| treeview.js 500줄 초과 | 중간 | 컨텍스트 메뉴 별도 모듈 분리 |
